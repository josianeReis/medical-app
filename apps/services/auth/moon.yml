id: auth
type: application
language: typescript
stack: backend
platform: bun
tags:
  - backend
  - app

project:
  name: "laudos-services/auth"
  description: "Auth"
  channel: "#auth"

tasks:
  local:
    command: infisical run --env local -- bun run --watch --inspect=4011/auth src/index.ts
    # args:
    #   - '--inspect'
    local: true
    deps:
      - "data-access:migration-up"
  dev:
    command: infisical run --env dev -- bun run --watch --inspect=4011/auth src/index.ts
    # args:
    #   - '--inspect'
    local: true
    deps:
      - "data-access:migration-up-dev"
  build:
    command: bun build
    args:
      - "--compile"
      - "--minify-whitespace"
      - "--minify-syntax"
      - "--target=bun"
      - "--outfile=server"
      - "./src/index.ts"
    outputs:
      - "server"
  start:
    command: infisical run --env prod -- ./server
    inputs:
      - "server"
  migration-create:
    command: bunx @better-auth/cli@latest generate
  openapi-generate:
    command: bun run src/utils/helpers/generateOpenApi.ts

dependsOn:
  - data-access
  - utils
  - email-templates
